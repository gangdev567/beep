<!DOCTYPE html>
<html xmlns="http://www.thymeleaf.org"
      xmlns:sec="http://www.thymeleaf.org/thymeleaf-extras-springsecurity6">

<head th:replace="~{layout/fragments :: myhead}"></head>

<body>

<header th:replace="~{layout/fragments :: myheader}"></header>

<nav th:replace="~{layout/fragments :: mysidebar}"></nav>

<section class="home">

<div class="container mt-5 text-white">
        
    <h5 class="my-3 fw-bold">닉네임 검색 결과</h5>
    <div class="row" th:if="${channelUserAccountEntitySearchResult}">
        <div class="col-md-4 col-sm-6" th:each="user, iterStat : ${channelUserAccountEntitySearchResult}">
            <div class="card mb-3">
                <div class="card-body d-flex align-items-center">
                    <!-- 프로필 사진 -->
                    <img th:src="${user.channelProfileImg}" class="rounded-circle mr-3" style="width: 50px; height: 50px;" alt="User Profile Image">
                    <!-- 텍스트 정보 -->
                    <div class="mx-3">
                        <a th:href="@{/channel/{userNickname}(userNickname=${user.channelUserAccountEntity.userNickname})}" class="text-decoration-none">
                            <strong>
                                <span th:text="${user.channelUserAccountEntity.userNickname}"></span>
                            </strong>
                        </a>
                    </div>
                    <div class="d-flex">
                        <input class="d-none data-channelUserNickname" th:value="${user.channelUserAccountEntity.userNickname}">
                        <input class="d-none data-loginUserId" th:value="${userAccount} ? ${userAccount.userId} : 'anonymousUser'">
                        <input class="d-none data-channelUserId" th:value="${user.channelUserAccountEntity.userId}">
                        <button class="btn btn-outline-primary data-followBySearchResult d-none" type="button" onclick="follow()"><i class="fas fa-heart"></i></button>
                        <button class="btn btn-outline-danger data-unfollowBySearchResult d-none" type="button" onclick="unfollow()"><i class="fas fa-heart-broken"></i></button>
                    </div>
                </div>
            </div>
        </div>
    </div>
    <script src="/js/search-follow.js"></script>
        
    <hr class="text-white">

    <h5 class="my-3 fw-bold">방송제목 검색 결과</h5>
    <div class="row" th:if="${channelSearchResult}">
            <div class="col-md-4" th:each="channel, iterStat : ${channelSearchResult}" th:if="${channel.streamingStateSet.toString().contains('ON')}">
                <div class="card border-dark mb-3">
                    <a class="video-card-thumbnail position-relative" th:href="@{/channel/{nickname}(nickname=${channel.channelUserAccountEntity.userNickname})}">
                        <img src="https://livecloud-thumb.akamaized.net/chzzk/livecloud/KR/stream/26760407/live/4249524/record/24711646/thumbnail/image_480.jpg" class="card-img-top rounded-3" alt="Video Thumbnail">
                        <div class="live-badge-container position-absolute top-0 start-0 mt-3 ms-3">
                            <span class="badge bg-danger">LIVE</span>
                            <span class="badge bg-secondary ms-1" th:text="${channel.channelViewerCount + ' 명'}"></span>
                        </div>
                    </a>
                    <div class="card-body d-flex flex-column justify-content-between">
                        <div class="video-card-profile mb-2">
                            <a class="video-card-image" th:href="@{/channel/{nickname}(nickname=${channel.channelUserAccountEntity.userNickname})}">
                                <img th:src="${channel.channelProfileImg}" alt="channelProfileImg" class="rounded-circle" style="width: 40px; height: 40px;">
                            </a>
                        </div>
                        <div class="video-card-area mb-2">
                            <a class="video-card-title text-decoration-none" th:href="@{/channel/{nickname}(nickname=${channel.channelUserAccountEntity.userNickname})}">
                                <span class="video-title" style="text-decoration: none; color: black; font-weight: bold;" th:text="${channel.channelTitle}"></span>
                            </a>
                            <div class="video-card-name">
                                <a class="video-card-channel text-decoration-none" th:href="@{/channel/{nickname}(nickname=${channel.channelUserAccountEntity.userNickname})}">
                                    <span class="name-ellipsis">
                                        <span class="name-text" style="text-decoration: none; color: black; font-weight: bold;" th:text="${channel.channelUserAccountEntity.userNickname}"></span>
                                    </span>
                                </a>
                            </div>
                        </div>
                        <div class="video-card-information mt-2" th:if="${channel.categoryEntityOfChannel != null}">
                            <a class="video-card-item text-decoration-none" th:href="@{/categories/{categoryId}(categoryId=${channel.categoryEntityOfChannel.categoryId})}">
                                <span class="badge bg-secondary" th:text="${channel.categoryEntityOfChannel.categoryName}"></span>
                            </a>
                        </div>
                    </div>
                </div>
            </div>
    </div>

    <hr class="text-white">

    
        <h5 class="my-3 fw-bold">카테고리 검색 결과</h5>
        
    <div class="row">
        <div th:if="${categorySearchResult}" th:each="category : ${categorySearchResult}" class="col-lg-2 col-md-4 mb-4">
            <div class="card category-card">
                <a th:href="@{/categories/{categoryId}(categoryId=${category.categoryId})}" class="card-link text-decoration-none">
                    <img th:src="${category.categoryImageUrl}" class="card-img-top img-fluid" alt="Category Image">
                    <div class="card-body">
                        <h5 class="card-title category-title text-left text-black text-truncate fs-5" th:text="${category.categoryName}">Category Name</h5>
                        <h5 class="card-title category-title text-left text-black text-truncate fs-6" th:text="${category.categoryTotalView != null ? '시청자 ' + category.categoryTotalView + '명' : '시청자 0명'}"></h5>
                    </div>
                </a>
            </div>
        </div>
    </div>

    <hr class="text-white">

</div>

<footer th:replace="layout/fragments :: myfooter"></footer>
</section>



<div th:replace="~{layout/fragments :: myModal}"></div>

<script th:replace="~{layout/fragments :: sidebar_js}"></script>
<script th:replace="~{layout/fragments :: bootstrap_js}"></script>
<script src="/js/broadcast.js"></script>
<script src="/js/fragments-categories-search.js"></script>
</body>

</html>